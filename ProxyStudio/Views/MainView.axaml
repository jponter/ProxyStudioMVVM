<!--
ProxyStudio - A cross-platform proxy management application.
Copyright (C) 2025 James Ponter
 
 This program is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.
 
 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 GNU General Public License for more details.
 
 You should have received a copy of the GNU General Public License
 along with this program. If not, see <https://www.gnu.org/licenses/>.
-->

<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:li="using:LoadingIndicators.Avalonia"
        xmlns:views="clr-namespace:ProxyStudio.Views"
        xmlns:vm="clr-namespace:ProxyStudio.ViewModels"
        xmlns:behaviors="clr-namespace:ProxyStudio.Behaviors"
       
        xmlns:converters="clr-namespace:ProxyStudio.Converters"
        d:DesignWidth="2000" d:DesignHeight="900"
        
        Width="1400" Height="900"
        MinWidth="1850" MinHeight="800"
        Background="{DynamicResource BackgroundBrush}"
        x:Class="ProxyStudio.Views.MainView"
        x:DataType="vm:MainViewModel"
        Title="ProxyStudio"
        Icon="/Resources/Proxy Studio Logo.png"
>

    <!-- Design-time DataContext -->
    <Design.DataContext>
        <vm:DesignTimeMainViewModel />
    </Design.DataContext>

    <Grid Background="{DynamicResource BackgroundBrush}" >
        
        <!-- Modern Tab Control -->
        <TabControl Name="MainTabControl"  >
            
            <!-- Cards Tab -->
            <TabItem Classes="">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <Label FontFamily="{DynamicResource Phosphor}" 
                               FontSize="20"
                               VerticalAlignment="Center"
                               Content="&#xE0F8;"/>
                        <TextBlock Text="Cards" Classes="" FontSize="20"/>
                    </StackPanel>
                </TabItem.Header>
                
                <!-- Card Management Page -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="340"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="450"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Modern Sidebar -->
                    <Border Grid.Column="0" 
                            Classes="sidebar card-elevated"
                            Background="{DynamicResource SurfaceElevatedBrush}"
                            BorderBrush="{DynamicResource BorderBrush}"
                            BorderThickness="0,0,1,0"
                            >
                        <ScrollViewer Classes="sidebar">
                            <StackPanel Spacing="8">
                                
                                <!-- Header -->
                                <StackPanel Spacing="8" >
                                    <TextBlock Classes="heading-medium" 
                                               Text="Card Actions"
                                               Foreground="{DynamicResource TextPrimaryColor}"
                                               />
                                    <TextBlock Classes="body-medium" Text="Manage your card collection"
                                               Foreground="{DynamicResource TextSecondaryColor}"/>
                                </StackPanel>
                                
                                <!-- Action Buttons -->
                                <StackPanel Spacing="12">
                                    
                                    <Button Classes="secondary" 
                                            Background="{DynamicResource SecondaryBrush}"
                                            Foreground="{DynamicResource TextOnSecondaryBrush}"
                                            
                                            Command ="{Binding LoadSingleImageCommand}"
                                            IsEnabled="{Binding !IsLoadingSingleImage}"
                                            HorizontalAlignment="Stretch"
                                            ToolTip.Tip="Add single or multiple local card images to the collection">
                                    <StackPanel Orientation="Horizontal" Spacing="6">
                                        <Label Classes="icon" 
                                               FontSize="24"
                                               
                                               Content="&#xE3D6;"/>
                                        <TextBlock Text="Add Local Card Image(s)" Classes="" FontSize="16" Padding="0,5,0,0"/>
                                    </StackPanel>
                                            
                                            </Button>
                                            
                                    
                                    <Button Classes="primary"
                                            
                                            HorizontalAlignment="Stretch"
                                            
                                            Command="{Binding LoadMpcFillXmlCommand}"
                                            IsEnabled="{Binding !IsLoadingMpcFill}"
                                            ToolTip.Tip="Load an MPC Fill XML file to import cards to the collection"> 
                                            <StackPanel Orientation="Horizontal" Spacing="6">
                                                
                                                <Label Classes="icon" 
                                                       FontSize="24"
                                                       
                                                       Content="&#xE1AC;"/>
                                                <TextBlock Text="Load MPC Fill XML" Classes="" FontSize="16" Padding="0,5,0,0"/>
                                            </StackPanel>
                                    </Button>
                                            
                                    
                                    <!-- <Button Classes="secondary"  -->
                                    <!--         Content="🧪 Load Test Cards" -->
                                    <!--         HorizontalAlignment="Stretch" -->
                                    <!--         Command="{Binding AddTestCardsRelayCommand}"/> -->
                                    
                                    <Button Classes="error"
                                            
                                            
                                            
                                            HorizontalAlignment="Stretch"
                                            Command="{Binding DeleteAllCardsCommand}"
                                            
                                            ToolTip.Tip="Remove all cards from the collection and clear preview">
                                        <StackPanel Orientation="Horizontal" Spacing="6">
                                                
                                            <Label Classes="icon" 
                                                   FontSize="24"
                                                   Content="&#xE4A6;"/>
                                            <TextBlock Text="Delete All Cards" Classes="" FontSize="16" Padding="0,5,0,0"/>
                                        </StackPanel>
                                        </Button>
                                    
                                </StackPanel>
                                
                                
                                <!-- IsVisible="{Binding ShowMpcFillProgress}" -->
                                <!-- MPC Fill Progress Section -->
                                <Border Classes="card highlight-primary"
                                        Width="275"
                                        IsVisible="{Binding ShowMpcFillProgress}"
                                        >
                                    <StackPanel Spacing="12">
                                        <StackPanel Orientation="Horizontal" Spacing="8">
                                            <TextBlock Text="📥" FontSize="16"/>
                                            <TextBlock Classes="heading-small" Text="MPC Fill Import"/>
                                        </StackPanel>
                                        
                                        <!-- Progress Bar -->
                                        <ProgressBar Classes="card highlight-primary"
                                                     Foreground="{DynamicResource PrimaryBrush}"
                                                     Background="{DynamicResource SurfaceBrush}"
                                                     Value="{Binding MpcFillProgress}"
                                                     Minimum="0" Maximum="100"/>
                                        
                                        <StackPanel Spacing="6">
                                            <TextBlock Classes="body-small" 
                                                      Text="{Binding MpcFillStatus}"
                                                      TextWrapping="Wrap"/>
                                            
                                            <TextBlock Classes="caption" 
                                                      Text="{Binding MpcFillCurrentOperation}"
                                                      TextWrapping="Wrap"/>
                                            
                                            <TextBlock Classes="caption" 
                                                      Text="{Binding MpcFillCurrentCard}"
                                                      TextWrapping="Wrap"
                                                      IsVisible="{Binding MpcFillCurrentCard, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                            
                                            <TextBlock Classes="body-small" 
                                                      Text="{Binding MpcFillTimeRemaining}"
                                                      Foreground="{DynamicResource SuccessBrush}"
                                                      IsVisible="{Binding MpcFillTimeRemaining, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                                
                                <!-- IsVisible="{Binding IsBusy}" -->
                                <!-- Loading Indicator -->
                                <Border Classes="card highlight-primary" 
                                        Width="275" Height="200"
                                        IsVisible="{Binding IsBusy}">
                                    
                                    <StackPanel Spacing="12" HorizontalAlignment="Center">
                                        <li:LoadingIndicator Foreground="{DynamicResource PrimaryBrush}" 
                                                           IsActive="{Binding IsBusy}" 
                                                           Mode="ThreeDots" 
                                                           SpeedRatio="1.2"/>
                                        <TextBlock Classes="body-small" 
                                                  Text="Processing..." 
                                                  HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                    
                    <!-- Main Card Grid View -->
                    <Border Grid.Column="1"
                            Classes="card"
                            
                            Margin="24,20,24,20">
                        <DockPanel >
                            
                            <!-- Grid Header -->
                            <Border DockPanel.Dock="Top" 
                                    Padding="0,0,0,16" 
                                    BorderBrush="{DynamicResource BorderBrush}"
                                    BorderThickness="0,0,0,1"
                                    >
                                <Grid >
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0" Spacing="4">
                                        <TextBlock Classes="heading-medium" Text="Card Collection"
                                                   Foreground="{DynamicResource TextPrimaryColor}"/>
                                        <TextBlock Classes="body-small" 
                                                  Text="{Binding Cards.Count, StringFormat='{}Total cards: {0}'}"/>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                                        <Button Classes="icon" Content="🔍" ToolTip.Tip="Search cards"/>
                                        <Button Classes="icon" Content="⚙️" ToolTip.Tip="Grid settings"/>
                                    </StackPanel>
                                </Grid>
                            </Border>
                            
                            <!-- Card Grid -->
                            <ScrollViewer Classes="preview" 
                                          x:Name="CardScrollViewer"
                                          VerticalScrollBarVisibility="Auto"
                                          HorizontalScrollBarVisibility="Auto"
                                          Background="{DynamicResource PreviewBackgroundBrush}"
                                          Padding="40">
                                <Panel>
                                    <!-- Card Grid -->
                                    <ListBox x:Name="CardGrid"
                                             ItemsSource="{Binding Cards}"
                                             SelectedItem="{Binding SelectedCard, Mode=TwoWay}"
                                             behaviors:ReorderableListBoxBehavior.IsReorderEnabled="True"
                                             behaviors:ReorderableListBoxBehavior.AcceptXmlFiles="True"
                                             DragDrop.AllowDrop="True"
                                             Background="Transparent"
                                             BorderThickness="0"
                                             Padding="0,0,0,200">
                                        
                                        <ListBox.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <UniformGrid x:Name="ResponsiveUniformGrid"
                                                             Columns="3"
                                                             />
                                                             
                                                             
                                            </ItemsPanelTemplate>
                                        </ListBox.ItemsPanel>
                                        
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="{DynamicResource SurfaceElevatedBrush}"
                                                        BorderBrush="{DynamicResource BorderBrush}"
                                                        BorderThickness="1"
                                                        CornerRadius="8"
                                                        Margin="4"
                                                        Padding="8"
                                                        Classes="card-compact"
                                                        MinWidth="421"
                                                        MaxWidth="421"
                                                        > 
                                                    
                                                    <StackPanel Spacing="8">
                                                        <!-- Card Name -->
                                                        <TextBlock Classes="body-small" 
                                                                  Text="{Binding Name}" 
                                                                  FontWeight="SemiBold"
                                                                  TextTrimming="CharacterEllipsis"
                                                                  ToolTip.Tip="{Binding Name}"/>
                                                        
                                                        <!-- Card Image -->
                                                        <Border CornerRadius="12" 
                                                                ClipToBounds="True"
                                                                Height="450">
                                                            <Image Source="{Binding ImageSource}" 
                                                                   Stretch="Uniform"
                                                                   
                                                                   />
                                                        </Border>
                                                        
                                                        <!-- Card Actions -->
                                                        <StackPanel Orientation="Horizontal" 
                                                                   HorizontalAlignment="Center" 
                                                                   Spacing="1">
                                                            <Button Classes="iconfont"
                                                                     
                                                                    Background="{DynamicResource ErrorBrush}"
                                                                    
                                                                    Command="{Binding $parent[ListBox].((vm:MainViewModel)DataContext).DeleteCardCommand}"
                                                                    CommandParameter="{Binding}"
                                                                    ToolTip.Tip="Delete this card"
                                                                    Width="40" Height="40">
                                                                <Label FontFamily="{DynamicResource Phosphor}" 
                                                                       FontSize="16"
                                                                       VerticalAlignment="Center"
                                                                       Content="&#xe4a6;"
                                                                       
                                                                       />
                                                                    
                                                                    
                                                            </Button>
                                                        </StackPanel>
                                                    </StackPanel>
                                                </Border>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                    
                                    <!-- Empty State -->
                                    <Border Classes="card-elevated"
                                            Padding="48"
                                            HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"
                                            IsVisible="{Binding !Cards.Count}">
                                        <StackPanel Spacing="16" HorizontalAlignment="Center">
                                            <Label FontFamily="{DynamicResource Phosphor}" 
                                                   FontSize="64"
                                                   VerticalAlignment="Center"
                                                   HorizontalAlignment="Center"
                                                   Content="&#xEDBC;"
                                                   Opacity="0.3"/>
                                            <TextBlock Classes="heading-small" 
                                                      Text="No cards in collection" 
                                                      HorizontalAlignment="Center"/>
                                            <TextBlock Classes="body-medium" 
                                                      Text="Add cards by loading an MPC Fill XML file or adding test cards"
                                                      HorizontalAlignment="Center"
                                                      TextAlignment="Center"
                                                      MaxWidth="300"/>
                                            <StackPanel Orientation="Horizontal" Spacing="12" HorizontalAlignment="Center">
                                                <Button Classes="primary" 
                                                        Content="Load MPC Fill XML"
                                                        Command="{Binding LoadMpcFillXmlCommand}"/>
                                                <Button Classes="primary"
                                                        Content="Add Local Image(s)"
                                                        Command="{Binding LoadSingleImageCommand}"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>
                                </Panel>
                            </ScrollViewer>
                            
                        </DockPanel>
                    </Border>
                    
                    <!-- Modern Card Editor Panel -->
                    <Border Grid.Column="2" Classes="sidebar" BorderThickness="1,0,0,0">
                        <ScrollViewer Classes="sidebar">
                            <StackPanel Spacing="20">
                                
                                <!-- ProxyStudio Branding -->
                                <StackPanel Spacing="12" HorizontalAlignment="Center">
                                    <Image Source="/Resources/Proxy Studio Logo.png"
                                           Width="120"
                                           Stretch="UniformToFill"/>
                                    <TextBlock Classes="caption" 
                                              Text="©PappaPonton 2025" 
                                              HorizontalAlignment="Center"/>
                                </StackPanel>
                                
                                <!-- Selected Card Section -->
                                <Border Classes="card"
                                        IsVisible="{Binding SelectedCard, Converter={x:Static ObjectConverters.IsNotNull}}">
                                    <StackPanel Spacing="16">
                                        <TextBlock Classes="heading-small" Text="Selected Card"/>
                                        
                                        <!-- Card Preview -->
                                        <Border CornerRadius="12" 
                                                ClipToBounds="True"
                                                MaxHeight="400">
                                            <Image Source="{Binding SelectedCard.ImageSource}"
                                                   Stretch="Uniform"/>
                                        </Border>
                                        
                                        <!-- Card Details -->
                                        <StackPanel Spacing="12">
                                            <StackPanel Spacing="4">
                                                <TextBlock Classes="caption" Text="CARD NAME"/>
                                                <TextBox Classes="modern"
                                                        Text="{Binding SelectedCard.Name}"
                                                        IsReadOnly="True"/>
                                            </StackPanel>
                                            
                                            <CheckBox Content="Enable Bleed"
                                                     IsChecked="{Binding SelectedCard.EnableBleed}"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                                
                                <!-- No Selection State -->
                                <Border Classes="card"
                                        IsVisible="{Binding SelectedCard, Converter={x:Static ObjectConverters.IsNull}}">
                                    <StackPanel Spacing="12" HorizontalAlignment="Center">
                                        <TextBlock Text="👆" FontSize="32" 
                                                  HorizontalAlignment="Center" 
                                                  Opacity="0.5"/>
                                        <TextBlock Classes="body-medium" 
                                                  Text="Select a card to edit"
                                                  HorizontalAlignment="Center"/>
                                        <TextBlock Classes="body-small" 
                                                  Text="Click on any card in the grid to view its details"
                                                  HorizontalAlignment="Center"
                                                  TextAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                    
                </Grid>
            </TabItem>
            
            <!-- Printing Tab -->
            <TabItem Classes="" >
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <Label FontFamily="{DynamicResource Phosphor}" 
                               FontSize="20"
                               VerticalAlignment="Center"
                               Content="&#xE3DC;"/>
                        <TextBlock Text="Printing" Classes="" FontSize="20"/>
                    </StackPanel>
                </TabItem.Header>
                <views:PrintingView DataContext="{Binding PrintViewModel}" />
            </TabItem>
            
            <!-- Settings Tab -->
            <TabItem Classes="" >
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <Label FontFamily="{DynamicResource Phosphor}" 
                               FontSize="20"
                               VerticalAlignment="Center"
                               Content="&#xE228;"/>
                        <TextBlock Text="Settings" Classes="" FontSize="20"/>
                    </StackPanel>
                </TabItem.Header>
                
                <Border Classes="card" Margin="20">
                    <ScrollViewer>
                        <StackPanel Spacing="24">
                            
                            <!-- Settings Header -->
                            <StackPanel Spacing="8">
                                <TextBlock Classes="heading-medium" Text="Application Settings"/>
                                <TextBlock Classes="body-medium" Text="Configure ProxyStudio preferences"/>
                            </StackPanel>
                            
                            <!-- Global Card Settings -->
                            <Border Classes="card-elevated">
                                <StackPanel Spacing="16">
                                    <TextBlock Classes="heading-small" Text="Global Card Settings"/>
                                    
                                    <StackPanel Spacing="12">
                                        <CheckBox Content="Enable bleed for all new cards"
                                                 IsChecked="{Binding GlobalBleedEnabled}"/>
                                        <TextBlock Classes="body-small" 
                                                  Text="When enabled, all newly imported cards will have bleed enabled by default"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            
                            
                            
                            <!-- Theme Settings -->
                            <Border Classes="card-elevated ">
                                <StackPanel Spacing="16">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <TextBlock Text="🎨" FontSize="16"/>
                                        <TextBlock Classes="heading-small" Text="Theme Settings"/>
                                    </StackPanel>
                                    
                                    <TextBlock Classes="body-medium" Text="Choose your preferred theme:"/>
                                    
                                    <ItemsControl ItemsSource="{Binding ThemeSettingsViewModel.AvailableThemes}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <UniformGrid Columns="2"/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Classes="card-compact" Margin="4">
                                                    <StackPanel Spacing="12">
                                                        <!-- Theme Preview Image -->
                                                        <Border Height="80" 
                                                                CornerRadius="8" 
                                                                Background="{DynamicResource SurfaceElevatedBrush}"
                                                                ClipToBounds="True">
                                                            <Image Source="{Binding PreviewImagePath}" 
                                                                   Stretch="UniformToFill"/>
                                                        </Border>
                                                        
                                                        <!-- Theme Info -->
                                                        <StackPanel Spacing="4">
                                                            <TextBlock Classes="body-medium" 
                                                                      Text="{Binding Name}" 
                                                                      FontWeight="SemiBold"/>
                                                            <TextBlock Classes="body-small" 
                                                                      Text="{Binding Description}" 
                                                                      Foreground="{DynamicResource TextSecondaryBrush}"
                                                                      TextWrapping="Wrap"/>
                                                        </StackPanel>
                                                        
                                                        <!-- Action Buttons -->
                                                        <StackPanel Orientation="Horizontal" Spacing="6">
                                                            <Button Classes="secondary" 
                                                                    Content="Preview" 
                                                                    FontSize="12"
                                                                    Padding="8,4"
                                                                    Command="{Binding $parent[ItemsControl].((vm:MainViewModel)DataContext).ThemeSettingsViewModel.PreviewThemeCommand}"
                                                                    CommandParameter="{Binding}"/>
                                                                    
                                                            <Button Classes="primary" 
                                                                    Content="Apply" 
                                                                    FontSize="12"
                                                                    Padding="8,4"
                                                                    Command="{Binding $parent[ItemsControl].((vm:MainViewModel)DataContext).ThemeSettingsViewModel.ApplyThemeCommand}"
                                                                    CommandParameter="{Binding}"/>
                                                        </StackPanel>
                                                    </StackPanel>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                    
                                    <!-- Current Theme Display -->
                                    <Border Classes="card-compact highlight-success">
                                        <StackPanel Spacing="8">
                                            <TextBlock Classes="body-medium" Text="Current Theme:" FontWeight="SemiBold"/>
                                            <TextBlock Classes="body-medium" 
                                                      Text="{Binding ThemeSettingsViewModel.SelectedTheme.Name}"
                                                      FontWeight="Bold"
                                                      Foreground="{DynamicResource PrimaryBrush}"/>
                                            <TextBlock Classes="body-small" 
                                                      Text="{Binding ThemeSettingsViewModel.SelectedTheme.Description}"
                                                      Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                       
                                            <Button Classes="secondary" 
                                                    Content="Reset to Saved Theme"
                                                    FontSize="12"
                                                    Padding="8,4"
                                                    HorizontalAlignment="Left"
                                                    Command="{Binding ThemeSettingsViewModel.ResetToSavedThemeCommand}"/>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </Border>
                            
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </TabItem>
            
            <!-- Theme Editor Tab -->
            <TabItem Classes="">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <Label FontFamily="{DynamicResource Phosphor}" 
                               FontSize="20"
                               VerticalAlignment="Center"
                               Content="&#xE6c8;"/>
                        <TextBlock Text="Theme Editor" Classes="" FontSize="20"/>
                    </StackPanel>
                </TabItem.Header>
                <views:ThemeEditorView DataContext="{Binding ThemeEditorViewModel}" />
            </TabItem>
            
            <!-- Logging Tab -->
            <TabItem Classes="" >
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <Label FontFamily="{DynamicResource Phosphor}" 
                               FontSize="20"
                               VerticalAlignment="Center"
                               Content="&#xE710;"/>
                        <TextBlock Text="Logging" Classes="" FontSize="20"/>
                    </StackPanel>
                </TabItem.Header>
                
                <Border Classes="card" Margin="20">
                    <ScrollViewer>
                        <StackPanel Spacing="24">
                            
                            <!-- Logging Header -->
                            <StackPanel Spacing="8">
                                <TextBlock Classes="heading-medium" Text="Logging Configuration"/>
                                <TextBlock Classes="body-medium" Text="Configure application logging and debugging"/>
                            </StackPanel>
                            
                            <!-- Logging Help and Tips -->
                            <Border Classes="card highlight-primary">
                                <StackPanel Spacing="16">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <TextBlock Text="💡" FontSize="16"/>
                                        <TextBlock Classes="heading-small" Text="Logging Help And Tips"/>
                                    </StackPanel>
                                    
                                    <StackPanel Spacing="12">
                                        <!-- Log Level Guidelines -->
                                        <StackPanel Spacing="6">
                                            <TextBlock Classes="body-medium" Text="Log Level Guidelines:" FontWeight="SemiBold"/>
                                            <StackPanel Spacing="2" Margin="12,0,0,0">
                                                <TextBlock Classes="body-small" Text="• Trace: Very detailed - use only for deep debugging"/>
                                                <TextBlock Classes="body-small" Text="• Debug: Development information - good for troubleshooting"/>
                                                <TextBlock Classes="body-small" Text="• Info: General operation info - recommended for normal use"/>
                                                <TextBlock Classes="body-small" Text="• Warning: Only warnings and errors - minimal logging"/>
                                                <TextBlock Classes="body-small" Text="• Error: Only errors - use when disk space is limited"/>
                                                <TextBlock Classes="body-small" Text="• Critical: Only critical failures - emergency use only"/>
                                            </StackPanel>
                                        </StackPanel>
                                        
                                        <!-- Performance Tips -->
                                        <StackPanel Spacing="6">
                                            <TextBlock Classes="body-medium" Text="Performance Tips:" FontWeight="SemiBold"/>
                                            <StackPanel Spacing="2" Margin="12,0,0,0">
                                                <TextBlock Classes="body-small" Text="• Lower log levels improve performance but provide less detail"/>
                                                <TextBlock Classes="body-small" Text="• Performance logging adds overhead but helps identify bottlenecks"/>
                                                <TextBlock Classes="body-small" Text="• Console output can slow down the application"/>
                                                <TextBlock Classes="body-small" Text="• Regular log cleanup prevents disk space issues"/>
                                            </StackPanel>
                                        </StackPanel>
                                        
                                        <!-- Troubleshooting -->
                                        <StackPanel Spacing="6">
                                            <TextBlock Classes="body-medium" Text="Troubleshooting:" FontWeight="SemiBold"/>
                                            <StackPanel Spacing="2" Margin="12,0,0,0">
                                                <TextBlock Classes="body-small" Text="• Set to Debug level when reporting bugs"/>
                                                <TextBlock Classes="body-small" Text="• Check Recent Errors for quick issue identification"/>
                                                <TextBlock Classes="body-small" Text="• Log files contain full stack traces for detailed analysis"/>
                                                <TextBlock Classes="body-small" Text="• Use Test Logging to verify configuration changes"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            
                            <!-- Logging Configuration -->
                            <Border Classes="card highlight-primary">
                                <StackPanel Spacing="16">
                                    <TextBlock Classes="heading-small" Text="Log Level"/>
                                    
                                    <StackPanel Spacing="12">
                                        <StackPanel Spacing="4">
                                            <TextBlock Classes="caption" Text="MINIMUM LOG LEVEL"/>
                                            <ComboBox SelectedIndex="{Binding LoggingSettingsViewModel.SelectedLogLevel}"
                                                     Classes="modern">
                                                <ComboBoxItem>
                                                    <StackPanel>
                                                        <TextBlock Text="Trace" Classes="body-medium" FontWeight="SemiBold"/>
                                                        <TextBlock Text="Very detailed logging (everything)" Classes="caption"/>
                                                    </StackPanel>
                                                </ComboBoxItem>
                                                <ComboBoxItem>
                                                    <StackPanel>
                                                        <TextBlock Text="Debug" Classes="body-medium" FontWeight="SemiBold"/>
                                                        <TextBlock Text="Development debugging information" Classes="caption"/>
                                                    </StackPanel>
                                                </ComboBoxItem>
                                                <ComboBoxItem>
                                                    <StackPanel>
                                                        <TextBlock Text="Info" Classes="body-medium" FontWeight="SemiBold"/>
                                                        <TextBlock Text="General information (recommended)" Classes="caption"/>
                                                    </StackPanel>
                                                </ComboBoxItem>
                                                <ComboBoxItem>
                                                    <StackPanel>
                                                        <TextBlock Text="Warning" Classes="body-medium" FontWeight="SemiBold"/>
                                                        <TextBlock Text="Warning messages only" Classes="caption"/>
                                                    </StackPanel>
                                                </ComboBoxItem>
                                                <ComboBoxItem>
                                                    <StackPanel>
                                                        <TextBlock Text="Error" Classes="body-medium" FontWeight="SemiBold"/>
                                                        <TextBlock Text="Error messages only" Classes="caption"/>
                                                    </StackPanel>
                                                </ComboBoxItem>
                                                <ComboBoxItem>
                                                    <StackPanel>
                                                        <TextBlock Text="Critical" Classes="body-medium" FontWeight="SemiBold"/>
                                                        <TextBlock Text="Critical errors only" Classes="caption"/>
                                                    </StackPanel>
                                                </ComboBoxItem>
                                            </ComboBox>
                                        </StackPanel>
                                        
                                        <StackPanel Spacing="8">
                                            <CheckBox Content="Enable performance logging"
                                                     IsChecked="{Binding LoggingSettingsViewModel.EnablePerformanceLogging}"/>
                                            <CheckBox Content="Show debug output in console"
                                                     IsChecked="{Binding LoggingSettingsViewModel.EnableConsoleOutput}"/>
                                            <CheckBox Content="Include stack traces in error logs"
                                                     IsChecked="{Binding LoggingSettingsViewModel.IncludeStackTraces}"/>
                                        </StackPanel>
                                        
                                        <!-- Action Buttons -->
                                        <StackPanel Orientation="Horizontal" Spacing="12">
                                            <Button Classes="success" 
                                                    Content="Save Settings"
                                                    Command="{Binding LoggingSettingsViewModel.SaveSettingsCommand}"/>
                                            <Button Classes="primary" 
                                                    Content="Test Logging"
                                                    Command="{Binding LoggingSettingsViewModel.TestLoggingCommand}"/>
                                            <Button Classes="secondary" 
                                                    Content="Open Log Folder"
                                                    Command="{Binding LoggingSettingsViewModel.OpenLogDirectoryCommand}"/>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            
                            <!-- Current Log Status -->
                            <Border Classes="card highlight-primary">
                                <StackPanel Spacing="12">
                                    <TextBlock Classes="heading-small" Text="Current Log Status"/>
                                    
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        
                                        <TextBlock Grid.Row="0" Grid.Column="0" 
                                                  Classes="body-small" Text="Current Level:" FontWeight="SemiBold"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" 
                                                  Classes="body-small"
                                                  Text="{Binding LoggingSettingsViewModel.CurrentLogLevelName}"
                                                  Foreground="{DynamicResource PrimaryBrush}"/>
                                        
                                        <TextBlock Grid.Row="1" Grid.Column="0" 
                                                  Classes="body-small" Text="Log File Size:" FontWeight="SemiBold"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" 
                                                  Classes="body-small"
                                                  Text="{Binding LoggingSettingsViewModel.CurrentLogFileSizeFormatted}"
                                                  Foreground="{DynamicResource SuccessBrush}"/>
                                        
                                        <TextBlock Grid.Row="2" Grid.Column="0" 
                                                  Classes="body-small" Text="Recent Errors:" FontWeight="SemiBold"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" 
                                                  Classes="body-small"
                                                  Text="{Binding LoggingSettingsViewModel.RecentErrors.Count, StringFormat='{}{0} errors logged'}"
                                                  Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            
                            <!-- Recent Errors Display -->
                            <Border Classes="card highlight-primary">
                                <StackPanel Spacing="16">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <TextBlock Text="⚠️" FontSize="16"/>
                                        <TextBlock Classes="heading-small" Text="Recent Errors"/>
                                    </StackPanel>
                                    
                                    <TextBlock Classes="body-small" 
                                              Text="Recent errors and warnings from the application"
                                              Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    
                                    <!-- Errors List -->
                                    <Border Classes="card-compact" 
                                            BorderBrush="{DynamicResource BorderBrush}" 
                                            BorderThickness="1"
                                            MaxHeight="400">
                                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                                            <Panel>
                                                <!-- Error Items -->
                                                <ItemsControl ItemsSource="{Binding LoggingSettingsViewModel.RecentErrors}">
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <Border Classes="card-compact" 
                                                                    Margin="0,0,0,8"
                                                                    Background="{DynamicResource SurfaceElevatedBrush}">
                                                                <StackPanel Spacing="6">
                                                                    <!-- Error Header -->
                                                                    <StackPanel Orientation="Horizontal" Spacing="12">
                                                                        <!-- Severity Badge -->
                                                                        <Border Classes="highlight-error" 
                                                                                Padding="6,2">
                                                                            <TextBlock Classes="caption" 
                                                                                      Text="{Binding Severity}"
                                                                                      Foreground="{DynamicResource ErrorBrush}"
                                                                                      FontWeight="SemiBold"/>
                                                                        </Border>
                                                                        
                                                                        <!-- Timestamp -->
                                                                        <TextBlock Classes="caption" 
                                                                                  Text="{Binding Timestamp, StringFormat='yyyy-MM-dd HH:mm:ss'}"
                                                                                  Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                                    </StackPanel>
                                                                    
                                                                    <!-- Error Title -->
                                                                    <TextBlock Classes="body-medium" 
                                                                              Text="{Binding Title}"
                                                                              FontWeight="SemiBold"
                                                                              Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                                    
                                                                    <!-- Error Message -->
                                                                    <TextBlock Classes="body-small" 
                                                                              Text="{Binding Message}"
                                                                              TextWrapping="Wrap"
                                                                              Foreground="{DynamicResource TextSecondaryBrush}"
                                                                              MaxWidth="500"/>
                                                                    
                                                                    <!-- Operation Context -->
                                                                    <TextBlock Classes="caption" 
                                                                              Text="{Binding OperationContext}"
                                                                              FontStyle="Italic"
                                                                              Foreground="{DynamicResource TextTertiary}"
                                                                              IsVisible="{Binding OperationContext, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                                                </StackPanel>
                                                            </Border>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                                
                                                <!-- No Errors State -->
                                                <Border Classes="card-compact" 
                                                        HorizontalAlignment="Center"
                                                        VerticalAlignment="Center"
                                                        Padding="24"
                                                        IsVisible="{Binding !LoggingSettingsViewModel.RecentErrors.Count}">
                                                    <StackPanel Spacing="8" HorizontalAlignment="Center">
                                                        <TextBlock Text="✅" FontSize="32" 
                                                                  HorizontalAlignment="Center" 
                                                                  Opacity="0.5"/>
                                                        <TextBlock Classes="body-medium" 
                                                                  Text="No recent errors found"
                                                                  HorizontalAlignment="Center"
                                                                  Foreground="{DynamicResource SuccessBrush}"
                                                                  FontWeight="SemiBold"/>
                                                        <TextBlock Classes="body-small" 
                                                                  Text="The application is running smoothly"
                                                                  HorizontalAlignment="Center"
                                                                  Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                    </StackPanel>
                                                </Border>
                                            </Panel>
                                        </ScrollViewer>
                                    </Border>
                                </StackPanel>
                            </Border>
                            
                            
                            
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </TabItem>
            
        </TabControl>
    </Grid>
</Window>